import{c as F,f as L,U as O,s as M,dR as A,r as k,i as e,V as W,dO as z,dP as N,dQ as D,dS as i,dT as Q,B as R,T as r,S as B,bB as G,aT as H,dk as K,dq as U,e0 as $,P as t}from"./vendor-5lkxkETF.js";import{f as x}from"./formatNumber-dGNhWwxT.js";import{K as q,g as Y,b as J,S as X}from"./index-DkbAsBWZ.js";import{h as Z,i as w,V as P,L as ee,B as ne}from"./AdminDashboardViaboSpei-B1bJP65o.js";import{i as V}from"./matchTypes-mENztEWg.js";import"./viabo-spei-paths-CvU5WLsk.js";import"./formatTime-jCgU2sMR.js";import"./TextMaxLine-B63DtfW-.js";import"./formik.esm-CTTSENmf.js";import"./UploadSingleFile-ByYCreVQ.js";import"./fade-CViozI82.js";import"./transition-anLY3gj9.js";import"./filterSearch-NGUmCbyG.js";import"./usePagination-Xa7qo0UK.js";import"./HeaderPage-Bqn_U64p.js";const ie=(n,l,c,j,g)=>{const u={destinationsAccounts:n==null?void 0:n.map(o=>{var a,p,d;return{bankAccount:(p=(a=o==null?void 0:o.account)==null?void 0:a.clabe)==null?void 0:p.toString(),amount:parseFloat((o==null?void 0:o.amount.toString())===""?"0":(d=o==null?void 0:o.amount)==null?void 0:d.toString().replace(/,/g,""))}}),concept:(l==null?void 0:l.toString())||"",googleAuthenticatorCode:(c==null?void 0:c.toString())||"",originBankAccount:j,internalTransaction:g};return console.log(u),q(u)},se=(n={})=>{const l=F(),c=L(Z,n);return{...c,mutate:async(g,u)=>{const{onSuccess:o,onError:a,mutationOptions:p}=u;try{const d=await O.promise(c.mutateAsync(g,p),{pending:"Enviando Transacciones ..."});l.invalidateQueries([w.ACCOUNTS_INFO]),l.invalidateQueries([P.BALANCE_RESUME]),l.invalidateQueries([P.MOVEMENTS]),V(o)&&o(d)}catch(d){const S=Y(d,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");V(a)&&a(S),O.error(S,{type:J(d)})}}}},m=M(A)(({theme:n})=>({"& td":{paddingTop:n.spacing(.5),paddingBottom:n.spacing(.5)}})),re=({data:n,onBack:l,setTransactionLoading:c,transactionLoading:j,onSuccess:g})=>{var C,E,I;const{mutate:u,isLoading:o}=se(),a=k.useMemo(()=>(n==null?void 0:n.transactions)||[],[n]),[p,d]=k.useState(""),S=()=>{const{transactions:s,concept:h,origin:b,internal:f}=n,y=ie(s,h,p,b,f);c(!0),u(y,{onSuccess:v=>{g(v)},onError:()=>{c(!1)}})},T=o||j;return e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[(n==null?void 0:n.insufficient)&&e.jsx(W,{sx:{borderRadius:0},severity:"warning",children:"Saldo insuficiente para realizar la operación"}),e.jsx(z,{sx:{minWidth:200},children:e.jsxs(N,{children:[e.jsx(D,{sx:{borderBottom:s=>`solid 1px ${s.palette.divider}`},children:e.jsxs(A,{children:[e.jsx(i,{width:40,children:"#"}),e.jsx(i,{align:"left",children:"Movimiento"}),e.jsx(i,{align:"right",children:"Monto"})]})}),e.jsxs(Q,{children:[a==null?void 0:a.map((s,h)=>{var b,f,y,v;return e.jsxs(A,{sx:{borderBottom:_=>`solid 1px ${_.palette.divider}`},children:[e.jsx(i,{children:h+1}),e.jsx(i,{align:"left",children:e.jsxs(R,{sx:{maxWidth:200},children:[e.jsx(r,{variant:"subtitle2",fontWeight:"bold",children:(b=s==null?void 0:s.account)==null?void 0:b.name}),e.jsx(r,{variant:"subtitle2",children:(y=(f=s==null?void 0:s.account)==null?void 0:f.bank)==null?void 0:y.name}),e.jsx(r,{variant:"subtitle2",children:(v=s==null?void 0:s.account)==null?void 0:v.clabe}),e.jsx(r,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:s==null?void 0:s.concept})]})}),e.jsx(i,{align:"right",children:x(s==null?void 0:s.amount)})]},h)}),e.jsxs(m,{children:[e.jsx(i,{colSpan:1}),e.jsx(i,{align:"right",children:e.jsx(B,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:e.jsx(r,{children:"Saldo disponible"})})}),e.jsx(i,{align:"right",width:120,children:e.jsx(r,{children:x(n==null?void 0:n.balance)})})]}),e.jsxs(m,{children:[e.jsx(i,{colSpan:1}),e.jsx(i,{align:"right",children:e.jsx(r,{variant:"h6",children:"Total a dispersar"})}),e.jsx(i,{align:"right",width:120,children:e.jsx(r,{variant:"h6",sx:{color:"error.main"},children:x(-(n==null?void 0:n.currentBalance))})})]}),e.jsxs(m,{children:[e.jsx(i,{colSpan:1}),e.jsx(i,{align:"right",children:e.jsx(r,{variant:"subtitle2",children:"Comisión por SPEI Out"})}),e.jsx(i,{align:"right",width:140,children:e.jsx(r,{sx:{color:"error.main"},children:x(-((C=n==null?void 0:n.commissions)==null?void 0:C.speiOut))})})]}),e.jsxs(m,{children:[e.jsx(i,{colSpan:1}),e.jsx(i,{align:"right",children:e.jsx(r,{variant:"subtitle2",children:"Fee STP"})}),e.jsx(i,{align:"right",width:140,children:e.jsx(r,{sx:{color:"error.main"},children:x(-((E=n==null?void 0:n.commissions)==null?void 0:E.fee))})})]}),e.jsxs(m,{children:[e.jsx(i,{colSpan:1}),e.jsx(i,{align:"right",children:e.jsx(r,{variant:"subtitle2",children:"Comisión por Operación Interna"})}),e.jsx(i,{align:"right",width:140,children:e.jsx(r,{sx:{color:"error.main"},children:x(-((I=n==null?void 0:n.commissions)==null?void 0:I.internalTransferCompany))})})]}),e.jsxs(m,{children:[e.jsx(i,{colSpan:1}),e.jsx(i,{align:"right",children:e.jsx(r,{variant:"subtitle1",children:"Saldo actualizado"})}),e.jsx(i,{align:"right",width:140,children:e.jsx(r,{children:x(n==null?void 0:n.total)})})]})]})]})}),!(n!=null&&n.insufficient)&&e.jsxs(B,{spacing:1,p:3,justifyContent:"flex-end",alignItems:"flex-end",children:[e.jsxs(r,{paragraph:!0,variant:"overline",sx:{color:"text.disabled"},children:["Token de Google"," ",e.jsx(R,{component:"span",color:"error.main",children:"*"})]}),e.jsx(G,{name:"googleCode",type:"number",size:"small",placeholder:"000000",required:!0,value:p,onChange:s=>{var h;return d((h=s==null?void 0:s.target)==null?void 0:h.value)},inputProps:{pattern:"/^-?d+.?d*$/",min:"1"},InputProps:{startAdornment:e.jsx(H,{position:"start",children:e.jsx(K,{})})},disabled:T})]})]}),e.jsxs(B,{direction:{md:"row-reverse"},sx:{p:3},gap:3,children:[e.jsx(ee,{size:"large",onClick:S,endIcon:e.jsx(U,{}),loading:T,variant:"contained",color:"primary",fullWidth:!0,type:"submit",disabled:!p,sx:{fontWeight:"bold"},children:"Enviar"}),!T&&e.jsx(ne,{size:"large",onClick:l,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx($,{}),children:"Regresar"})]})]})};re.propTypes={data:t.shape({balance:t.any,commissions:t.shape({fee:t.any,internalTransferCompany:t.any,speiOut:t.any}),concept:t.any,currentBalance:t.any,insufficient:t.any,internal:t.any,origin:t.any,total:t.any,transactions:t.array}),onBack:t.func,onSuccess:t.func,setTransactionLoading:t.func,transactionLoading:t.any};export{re as default};
//# sourceMappingURL=SpeiOutResume-BJEmNpoW.js.map

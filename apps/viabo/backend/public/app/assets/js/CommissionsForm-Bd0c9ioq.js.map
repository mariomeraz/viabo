{"version":3,"file":"CommissionsForm-Bd0c9ioq.js","sources":["../../../../../frontend/src/app/management/commerces/adapters/commerceCommissionsAdapter.js","../../../../../frontend/src/app/management/commerces/hooks/useUpdateCommerceCommissions.js","../../../../../frontend/src/app/management/commerces/components/details/CommissionsForm.jsx"],"sourcesContent":["export const CommerceCommissionsAdapter = (commissions, commerceId) => ({\r\n  commerceId,\r\n  speiInCarnet: commissions?.speiInCarnet,\r\n  speiOutCarnet: commissions?.speiOutCarnet,\r\n  speiInMasterCard: commissions?.speiInMasterCard,\r\n  speiOutMasterCard: commissions?.speiOutMasterCard,\r\n  pay: commissions?.viaboPay,\r\n  sharedTerminal: commissions?.cloud\r\n})\r\n","import { useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { toast } from 'react-toastify'\r\n\r\nimport { MANAGEMENT_COMMERCES_KEYS } from '../adapters'\r\nimport { updateCommerceCommissions } from '../services'\r\n\r\nimport { getErrorAPI, getNotificationTypeByErrorCode } from '@/shared/interceptors'\r\n\r\nexport const useUpdateCommerceCommissions = (options = {}) => {\r\n  const client = useQueryClient()\r\n  const updateCommissions = useMutation(updateCommerceCommissions, options)\r\n  const commissions = async (formData, options) => {\r\n    const { onSuccess, onError, mutationOptions } = options\r\n\r\n    try {\r\n      await toast.promise(updateCommissions.mutateAsync(formData, mutationOptions), {\r\n        pending: 'Actualizando Comisiones ...',\r\n        success: {\r\n          render({ data }) {\r\n            client.invalidateQueries([MANAGEMENT_COMMERCES_KEYS.COMMERCE_LIST])\r\n            onSuccess(data)\r\n\r\n            return 'Se actualizaron las comisiones con éxito'\r\n          }\r\n        }\r\n      })\r\n    } catch (error) {\r\n      const errorFormatted = getErrorAPI(\r\n        error,\r\n        `No se puede realizar esta operacion en este momento. Intente nuevamente o reporte a sistemas`\r\n      )\r\n      onError(errorFormatted)\r\n      toast.error(errorFormatted, {\r\n        type: getNotificationTypeByErrorCode(error)\r\n      })\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...updateCommissions,\r\n    mutate: commissions\r\n  }\r\n}\r\n","import PropTypes from 'prop-types'\r\n\r\nimport { LoadingButton } from '@mui/lab'\r\nimport { Box, Divider, InputAdornment, Stack, Typography } from '@mui/material'\r\nimport { useFormik } from 'formik'\r\nimport * as Yup from 'yup'\r\n\r\nimport { CommerceCommissionsAdapter } from '../../adapters'\r\nimport { useUpdateCommerceCommissions } from '../../hooks'\r\n\r\nimport { FormProvider, RFTextField } from '@/shared/components/form'\r\nimport { CarnetLogo, MasterCardLogo, ViaboCoin, ViaboPayLogo } from '@/shared/components/images'\r\n\r\nCommissionsForm.propTypes = {\r\n  commerce: PropTypes.object.isRequired,\r\n  onSuccess: PropTypes.func\r\n}\r\n\r\nconst MIN_AMOUNT = 0\r\nconst MAX_AMOUNT = 50\r\nconst STEP = 0.1\r\n\r\nfunction CommissionsForm({ commerce, onSuccess }) {\r\n  const { commissions } = commerce\r\n  const { mutate, isLoading: isUpdatingCommissions } = useUpdateCommerceCommissions()\r\n\r\n  const percentageValidation = Yup.number()\r\n    .min(MIN_AMOUNT, 'El valor mínimo es 0')\r\n    .max(MAX_AMOUNT, 'El valor máximo es 50')\r\n    .required('El valor es requerido')\r\n\r\n  const registerValidation = Yup.object({\r\n    speiInCarnet: percentageValidation,\r\n    speiOutCarnet: percentageValidation,\r\n    speiInMasterCard: percentageValidation,\r\n    speiOutMasterCard: percentageValidation,\r\n    viaboPay: percentageValidation,\r\n    cloud: percentageValidation\r\n  })\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      speiInCarnet: commissions?.speiInCarnet || 0,\r\n      speiOutCarnet: commissions?.speiOutCarnet || 0,\r\n      speiInMasterCard: commissions?.speiInMasterCard || 0,\r\n      speiOutMasterCard: commissions?.speiOutMasterCard || 0,\r\n      viaboPay: commissions?.viaboPay || 0,\r\n      cloud: commissions?.cloud || 0\r\n    },\r\n    validationSchema: registerValidation,\r\n    enableReinitialize: true,\r\n    onSubmit: (values, { setSubmitting }) => {\r\n      const data = CommerceCommissionsAdapter(values, commerce?.id)\r\n      mutate(data, {\r\n        onSuccess: () => {\r\n          setSubmitting(false)\r\n          onSuccess()\r\n        },\r\n        onError: () => {\r\n          setSubmitting(false)\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  const { isSubmitting } = formik\r\n\r\n  const isLoading = isSubmitting || isUpdatingCommissions\r\n\r\n  return (\r\n    <FormProvider formik={formik}>\r\n      <Stack p={3} gap={3} flexDirection={'column'}>\r\n        <Stack gap={2}>\r\n          <Typography variant=\"subtitle2\">SPEI</Typography>\r\n          <Stack gap={3} flexDirection={'row'} flexWrap={'wrap'} alignItems={'center'} width={1}>\r\n            <CarnetLogo />\r\n\r\n            <Stack spacing={1} flexGrow={1}>\r\n              <Typography m={0} paragraph variant=\"overline\" sx={{ color: 'text.disabled' }}>\r\n                Entrantes:\r\n              </Typography>\r\n              <RFTextField\r\n                name=\"speiInCarnet\"\r\n                placeholder=\"0.0\"\r\n                autoFocus\r\n                focused\r\n                size={'small'}\r\n                type=\"number\"\r\n                required={true}\r\n                disabled={isLoading}\r\n                InputLabelProps={{\r\n                  shrink: true\r\n                }}\r\n                InputProps={{\r\n                  endAdornment: <InputAdornment position=\"start\">%</InputAdornment>\r\n                }}\r\n                inputProps={{ inputMode: 'numeric', min: MIN_AMOUNT, max: MAX_AMOUNT, step: STEP }}\r\n              />\r\n            </Stack>\r\n\r\n            <Stack spacing={1} flexGrow={1}>\r\n              <Typography m={0} paragraph variant=\"overline\" sx={{ color: 'text.disabled' }}>\r\n                Salientes:\r\n              </Typography>\r\n              <RFTextField\r\n                name=\"speiOutCarnet\"\r\n                placeholder=\"0\"\r\n                type=\"number\"\r\n                required={true}\r\n                size={'small'}\r\n                disabled={isLoading}\r\n                InputLabelProps={{\r\n                  shrink: true\r\n                }}\r\n                InputProps={{\r\n                  endAdornment: <InputAdornment position=\"start\">%</InputAdornment>\r\n                }}\r\n                inputProps={{ inputMode: 'numeric', min: MIN_AMOUNT, max: MAX_AMOUNT, step: STEP }}\r\n              />\r\n            </Stack>\r\n          </Stack>\r\n\r\n          <Stack gap={3} flexDirection={'row'} flexWrap={'wrap'} alignItems={'center'} width={1}>\r\n            <MasterCardLogo />\r\n\r\n            <Stack spacing={1} flexGrow={1}>\r\n              <Typography m={0} paragraph variant=\"overline\" sx={{ color: 'text.disabled' }}>\r\n                Entrantes:\r\n              </Typography>\r\n              <RFTextField\r\n                name=\"speiInMasterCard\"\r\n                placeholder=\"0\"\r\n                required={true}\r\n                size={'small'}\r\n                type=\"number\"\r\n                disabled={isLoading}\r\n                InputLabelProps={{\r\n                  shrink: true\r\n                }}\r\n                InputProps={{\r\n                  endAdornment: <InputAdornment position=\"start\">%</InputAdornment>\r\n                }}\r\n                inputProps={{ inputMode: 'numeric', min: MIN_AMOUNT, max: MAX_AMOUNT, step: STEP }}\r\n              />\r\n            </Stack>\r\n\r\n            <Stack spacing={1} flexGrow={1}>\r\n              <Typography m={0} paragraph variant=\"overline\" sx={{ color: 'text.disabled' }}>\r\n                Salientes:\r\n              </Typography>\r\n              <RFTextField\r\n                name=\"speiOutMasterCard\"\r\n                placeholder=\"0\"\r\n                required={true}\r\n                type=\"number\"\r\n                size={'small'}\r\n                disabled={isLoading}\r\n                InputLabelProps={{\r\n                  shrink: true\r\n                }}\r\n                InputProps={{\r\n                  endAdornment: <InputAdornment position=\"start\">%</InputAdornment>\r\n                }}\r\n                inputProps={{ inputMode: 'numeric', min: MIN_AMOUNT, max: MAX_AMOUNT, step: STEP }}\r\n              />\r\n            </Stack>\r\n          </Stack>\r\n        </Stack>\r\n        <Divider flexItem sx={{ borderStyle: 'dashed' }} />\r\n        <Stack flexDirection={'row'} justifyContent={'space-between'} alignItems={'center'}>\r\n          <Stack gap={2} alignItems={'center'} flexDirection={'row'}>\r\n            <Stack flexDirection={'row'} gap={1} alignItems={'center'}>\r\n              <ViaboPayLogo sx={{ width: 40, height: 40 }} />\r\n            </Stack>\r\n            <RFTextField\r\n              name=\"viaboPay\"\r\n              placeholder=\"0\"\r\n              size={'small'}\r\n              type=\"number\"\r\n              required={true}\r\n              disabled={isLoading}\r\n              InputLabelProps={{\r\n                shrink: true\r\n              }}\r\n              InputProps={{\r\n                endAdornment: <InputAdornment position=\"start\">%</InputAdornment>\r\n              }}\r\n              inputProps={{ inputMode: 'numeric', min: MIN_AMOUNT, max: MAX_AMOUNT, step: STEP }}\r\n            />\r\n          </Stack>\r\n\r\n          <Stack gap={2} flexDirection={'row'} alignItems={'center'}>\r\n            <Stack flexDirection={'row'} gap={1} alignItems={'center'}>\r\n              <ViaboCoin sx={{ width: 35, height: 35 }} />\r\n            </Stack>\r\n\r\n            <RFTextField\r\n              name=\"cloud\"\r\n              placeholder=\"0\"\r\n              size={'small'}\r\n              type=\"number\"\r\n              required={true}\r\n              disabled={isLoading}\r\n              InputLabelProps={{\r\n                shrink: true\r\n              }}\r\n              InputProps={{\r\n                endAdornment: <InputAdornment position=\"start\">%</InputAdornment>\r\n              }}\r\n              inputProps={{ inputMode: 'numeric', min: MIN_AMOUNT, max: MAX_AMOUNT, step: STEP }}\r\n            />\r\n          </Stack>\r\n        </Stack>\r\n\r\n        <Box display={'flex'} pt={2}>\r\n          <LoadingButton fullWidth loading={isLoading} variant={'contained'} type=\"submit\" sx={{ fontWeight: 'bold' }}>\r\n            Guardar\r\n          </LoadingButton>\r\n        </Box>\r\n      </Stack>\r\n    </FormProvider>\r\n  )\r\n}\r\n\r\nexport default CommissionsForm\r\n"],"names":["CommerceCommissionsAdapter","commissions","commerceId","useUpdateCommerceCommissions","options","client","useQueryClient","updateCommissions","useMutation","updateCommerceCommissions","formData","onSuccess","onError","mutationOptions","toast","data","MANAGEMENT_COMMERCES_KEYS","error","errorFormatted","getErrorAPI","getNotificationTypeByErrorCode","CommissionsForm","propTypes","commerce","PropTypes","object","isRequired","func","MIN_AMOUNT","MAX_AMOUNT","STEP","mutate","isLoading","isUpdatingCommissions","percentageValidation","Yup","min","max","required","registerValidation","speiInCarnet","speiOutCarnet","speiInMasterCard","speiOutMasterCard","viaboPay","cloud","formik","useFormik","initialValues","validationSchema","enableReinitialize","onSubmit","values","setSubmitting","id","isSubmitting","jsx","FormProvider","jsxs","Stack","Typography","CarnetLogo","color","RFTextField","shrink","endAdornment","InputAdornment","inputMode","step","MasterCardLogo","Divider","borderStyle","ViaboPayLogo","width","height","ViaboCoin","Box","LoadingButton","fontWeight"],"mappings":"m9BAAO,MAAMA,EAA6B,CAACC,EAAaC,KAAgB,CACtE,WAAAA,EACA,aAAcD,GAAA,YAAAA,EAAa,aAC3B,cAAeA,GAAA,YAAAA,EAAa,cAC5B,iBAAkBA,GAAA,YAAAA,EAAa,iBAC/B,kBAAmBA,GAAA,YAAAA,EAAa,kBAChC,IAAKA,GAAA,YAAAA,EAAa,SAClB,eAAgBA,GAAA,YAAAA,EAAa,KAC/B,GCAaE,EAA+B,CAACC,EAAU,KAAO,CAC5D,MAAMC,EAASC,EAAgB,EACzBC,EAAoBC,EAAYC,EAA2BL,CAAO,EA4BxE,MAAO,CACL,GAAGG,EACH,OA7BkB,MAAOG,EAAUN,IAAY,CAC/C,KAAM,CAAE,UAAAO,EAAW,QAAAC,EAAS,gBAAAC,CAAiB,EAAGT,EAEhD,GAAI,CACF,MAAMU,EAAM,QAAQP,EAAkB,YAAYG,EAAUG,CAAe,EAAG,CAC5E,QAAS,8BACT,QAAS,CACP,OAAO,CAAE,KAAAE,GAAQ,CACf,OAAAV,EAAO,kBAAkB,CAACW,EAA0B,aAAa,CAAC,EAClEL,EAAUI,CAAI,EAEP,0CACR,CACF,CACT,CAAO,CACF,OAAQE,EAAO,CACd,MAAMC,EAAiBC,EACrBF,EACA,8FACD,EACDL,EAAQM,CAAc,EACtBJ,EAAM,MAAMI,EAAgB,CAC1B,KAAME,EAA+BH,CAAK,CAClD,CAAO,CACF,CACF,CAKA,CACH,EC7BAI,EAAgBC,UAAY,CAC1BC,SAAUC,EAAUC,OAAOC,WAC3Bf,UAAWa,EAAUG,IACvB,EAEA,MAAMC,EAAa,EACbC,EAAa,GACbC,EAAO,GAEb,SAAST,EAAgB,CAAEE,SAAAA,EAAUZ,UAAAA,CAAU,EAAG,CAC1C,KAAA,CAAEV,YAAAA,CAAgBsB,EAAAA,EAClB,CAAEQ,OAAAA,EAAQC,UAAWC,GAA0B9B,EAA6B,EAE5E+B,EAAuBC,EAAW,EACrCC,IAAIR,EAAY,sBAAsB,EACtCS,IAAIR,EAAY,uBAAuB,EACvCS,SAAS,uBAAuB,EAE7BC,EAAqBJ,EAAW,CACpCK,aAAcN,EACdO,cAAeP,EACfQ,iBAAkBR,EAClBS,kBAAmBT,EACnBU,SAAUV,EACVW,MAAOX,CAAAA,CACR,EAEKY,EAASC,EAAU,CACvBC,cAAe,CACbR,cAAcvC,GAAAA,YAAAA,EAAauC,eAAgB,EAC3CC,eAAexC,GAAAA,YAAAA,EAAawC,gBAAiB,EAC7CC,kBAAkBzC,GAAAA,YAAAA,EAAayC,mBAAoB,EACnDC,mBAAmB1C,GAAAA,YAAAA,EAAa0C,oBAAqB,EACrDC,UAAU3C,GAAAA,YAAAA,EAAa2C,WAAY,EACnCC,OAAO5C,GAAAA,YAAAA,EAAa4C,QAAS,CAC/B,EACAI,iBAAkBV,EAClBW,mBAAoB,GACpBC,SAAUA,CAACC,EAAQ,CAAEC,cAAAA,CAAAA,IAAoB,CACvC,MAAMtC,EAAOf,EAA2BoD,EAAQ7B,GAAAA,YAAAA,EAAU+B,EAAE,EAC5DvB,EAAOhB,EAAM,CACXJ,UAAWA,IAAM,CACf0C,EAAc,EAAK,EACT1C,GACZ,EACAC,QAASA,IAAM,CACbyC,EAAc,EAAK,CACrB,CAAA,CACD,CACH,CAAA,CACD,EAEK,CAAEE,aAAAA,CAAiBT,EAAAA,EAEnBd,EAAYuB,GAAgBtB,EAGhC,OAAAuB,EAAAA,IAACC,EAAa,CAAA,OAAAX,EACZ,SAACY,EAAA,KAAAC,EAAA,CAAM,EAAG,EAAG,IAAK,EAAG,cAAe,SAClC,SAAA,CAACD,EAAAA,KAAAC,EAAA,CAAM,IAAK,EACV,SAAA,CAACH,EAAA,IAAAI,EAAA,CAAW,QAAQ,YAAY,SAAI,OAAA,EACpCF,EAAAA,KAACC,EAAM,CAAA,IAAK,EAAG,cAAe,MAAO,SAAU,OAAQ,WAAY,SAAU,MAAO,EAClF,SAAA,CAAAH,EAAA,IAACK,EAAa,EAAA,EAEbH,EAAA,KAAAC,EAAA,CAAM,QAAS,EAAG,SAAU,EAC3B,SAAA,CAAAH,MAACI,GAAW,EAAG,EAAG,UAAS,GAAC,QAAQ,WAAW,GAAI,CAAEE,MAAO,eAAA,EAAmB,SAE/E,aAAA,QACCC,EACC,CAAA,KAAK,eACL,YAAY,MACZ,UAAS,GACT,QAAO,GACP,KAAM,QACN,KAAK,SACL,SAAU,GACV,SAAU/B,EACV,gBAAiB,CACfgC,OAAQ,IAEV,WAAY,CACVC,aAAcT,EAAA,IAACU,EAAe,CAAA,SAAS,QAAQ,SAAC,IAAA,GAElD,WAAY,CAAEC,UAAW,UAAW/B,IAAKR,EAAYS,IAAKR,EAAYuC,KAAMtC,CAAAA,EAC5E,CAAA,EACJ,EAEC4B,EAAA,KAAAC,EAAA,CAAM,QAAS,EAAG,SAAU,EAC3B,SAAA,CAAAH,MAACI,GAAW,EAAG,EAAG,UAAS,GAAC,QAAQ,WAAW,GAAI,CAAEE,MAAO,eAAA,EAAmB,SAE/E,aAAA,EACCN,EAAA,IAAAO,EAAA,CACC,KAAK,gBACL,YAAY,IACZ,KAAK,SACL,SAAU,GACV,KAAM,QACN,SAAU/B,EACV,gBAAiB,CACfgC,OAAQ,IAEV,WAAY,CACVC,aAAcT,EAAA,IAACU,EAAe,CAAA,SAAS,QAAQ,SAAC,IAAA,GAElD,WAAY,CAAEC,UAAW,UAAW/B,IAAKR,EAAYS,IAAKR,EAAYuC,KAAMtC,CAAAA,EAC5E,CAAA,EACJ,CAAA,EACF,EAEA4B,EAAAA,KAACC,EAAM,CAAA,IAAK,EAAG,cAAe,MAAO,SAAU,OAAQ,WAAY,SAAU,MAAO,EAClF,SAAA,CAAAH,EAAA,IAACa,EAAiB,EAAA,EAEjBX,EAAA,KAAAC,EAAA,CAAM,QAAS,EAAG,SAAU,EAC3B,SAAA,CAAAH,MAACI,GAAW,EAAG,EAAG,UAAS,GAAC,QAAQ,WAAW,GAAI,CAAEE,MAAO,eAAA,EAAmB,SAE/E,aAAA,EACCN,EAAA,IAAAO,EAAA,CACC,KAAK,mBACL,YAAY,IACZ,SAAU,GACV,KAAM,QACN,KAAK,SACL,SAAU/B,EACV,gBAAiB,CACfgC,OAAQ,IAEV,WAAY,CACVC,aAAcT,EAAA,IAACU,EAAe,CAAA,SAAS,QAAQ,SAAC,IAAA,GAElD,WAAY,CAAEC,UAAW,UAAW/B,IAAKR,EAAYS,IAAKR,EAAYuC,KAAMtC,CAAAA,EAC5E,CAAA,EACJ,EAEC4B,EAAA,KAAAC,EAAA,CAAM,QAAS,EAAG,SAAU,EAC3B,SAAA,CAAAH,MAACI,GAAW,EAAG,EAAG,UAAS,GAAC,QAAQ,WAAW,GAAI,CAAEE,MAAO,eAAA,EAAmB,SAE/E,aAAA,EACCN,EAAA,IAAAO,EAAA,CACC,KAAK,oBACL,YAAY,IACZ,SAAU,GACV,KAAK,SACL,KAAM,QACN,SAAU/B,EACV,gBAAiB,CACfgC,OAAQ,IAEV,WAAY,CACVC,aAAcT,EAAA,IAACU,EAAe,CAAA,SAAS,QAAQ,SAAC,IAAA,GAElD,WAAY,CAAEC,UAAW,UAAW/B,IAAKR,EAAYS,IAAKR,EAAYuC,KAAMtC,CAAAA,EAC5E,CAAA,EACJ,CAAA,EACF,CAAA,EACF,EACC0B,EAAAA,IAAAc,EAAA,CAAQ,SAAQ,GAAC,GAAI,CAAEC,YAAa,QAAA,EAAc,SAClDZ,EAAM,CAAA,cAAe,MAAO,eAAgB,gBAAiB,WAAY,SACxE,SAAA,CAAAD,OAACC,GAAM,IAAK,EAAG,WAAY,SAAU,cAAe,MAClD,SAAA,CAACH,EAAAA,IAAAG,EAAA,CAAM,cAAe,MAAO,IAAK,EAAG,WAAY,SAC/C,SAACH,EAAA,IAAAgB,EAAA,CAAa,GAAI,CAAEC,MAAO,GAAIC,OAAQ,IAAQ,CACjD,CAAA,EACClB,EAAA,IAAAO,EAAA,CACC,KAAK,WACL,YAAY,IACZ,KAAM,QACN,KAAK,SACL,SAAU,GACV,SAAU/B,EACV,gBAAiB,CACfgC,OAAQ,IAEV,WAAY,CACVC,aAAcT,EAAA,IAACU,EAAe,CAAA,SAAS,QAAQ,SAAC,IAAA,GAElD,WAAY,CAAEC,UAAW,UAAW/B,IAAKR,EAAYS,IAAKR,EAAYuC,KAAMtC,CAAAA,EAC5E,CAAA,EACJ,SAEC6B,EAAM,CAAA,IAAK,EAAG,cAAe,MAAO,WAAY,SAC/C,SAAA,CAACH,EAAAA,IAAAG,EAAA,CAAM,cAAe,MAAO,IAAK,EAAG,WAAY,SAC/C,SAACH,EAAA,IAAAmB,EAAA,CAAU,GAAI,CAAEF,MAAO,GAAIC,OAAQ,IAAQ,CAC9C,CAAA,EAEClB,EAAA,IAAAO,EAAA,CACC,KAAK,QACL,YAAY,IACZ,KAAM,QACN,KAAK,SACL,SAAU,GACV,SAAU/B,EACV,gBAAiB,CACfgC,OAAQ,IAEV,WAAY,CACVC,aAAcT,EAAA,IAACU,EAAe,CAAA,SAAS,QAAQ,SAAC,IAAA,GAElD,WAAY,CAAEC,UAAW,UAAW/B,IAAKR,EAAYS,IAAKR,EAAYuC,KAAMtC,CAAAA,EAC5E,CAAA,EACJ,CAAA,EACF,QAEC8C,EAAI,CAAA,QAAS,OAAQ,GAAI,EACxB,SAACpB,MAAAqB,EAAA,CAAc,UAAS,GAAC,QAAS7C,EAAW,QAAS,YAAa,KAAK,SAAS,GAAI,CAAE8C,WAAY,MAAA,EAAU,kBAE7G,CAAA,EACF,CAAA,CACF,CAAA,CACF,CAAA,CAEJ"}
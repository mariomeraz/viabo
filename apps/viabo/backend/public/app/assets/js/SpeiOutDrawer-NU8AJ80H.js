import{L as x,_ as g,j as xt,a7 as gt,R as _t,E as Ct}from"./index-DkbAsBWZ.js";import{r as s,i as n,S as $,bK as Et,bL as Ot,q as y,T as Ft}from"./vendor-5lkxkETF.js";import{g as jt,u as v,S as R,a as yt}from"./AdminDashboardViaboSpei-B1bJP65o.js";import{u as Rt}from"./useFindSpeiThirdAccountsList-B8tgoWra.js";import{R as tt}from"./RightPanel-DRwW1nHJ.js";import{v as L}from"./fade-CViozI82.js";import"./formatNumber-dGNhWwxT.js";import"./formatTime-jCgU2sMR.js";import"./matchTypes-mENztEWg.js";import"./TextMaxLine-B63DtfW-.js";import"./formik.esm-CTTSENmf.js";import"./UploadSingleFile-ByYCreVQ.js";import"./viabo-spei-paths-CvU5WLsk.js";import"./filterSearch-NGUmCbyG.js";import"./usePagination-Xa7qo0UK.js";import"./HeaderPage-Bqn_U64p.js";import"./transition-anLY3gj9.js";const Lt=x(s.lazy(()=>g(()=>import("./SpeiOutForm-C2ddF_HO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18])))),Pt=x(s.lazy(()=>g(()=>import("./SpeiOutConcentratorForm-mErhfqMO.js"),__vite__mapDeps([19,1,4,6,2,3,7,8,9,10,11,12,13,14,15,16,17])))),bt=x(s.lazy(()=>g(()=>import("./SpeiOutResume-BJEmNpoW.js"),__vite__mapDeps([20,1,7,2,3,6,8,9,10,4,11,12,13,14,15,16,17])))),At=x(s.lazy(()=>g(()=>import("./SpeiOutSuccess-DnFJPZbA.js"),__vite__mapDeps([21,1,6,2,3,7,8,9,10,4,11,12,13,14,15,16,17])))),Qt=()=>{const{twoAuth:P,permissions:b}=xt(),[i,A]=s.useState(null),r=s.useMemo(()=>jt(b),[b]),l=s.useMemo(()=>r==null?void 0:r.find(t=>t==null?void 0:t.default),[r]),D=i===R.COMPANIES.id,_=i===R.THIRD_ACCOUNTS.id,et=i===R.CONCENTRATOR.id,{setOpenSpeiOut:nt,openSpeiOut:a,selectedAccount:e}=v(),[I,C]=s.useState(0),[w,E]=s.useState(null),B=s.useMemo(()=>{var t;return(t=e==null?void 0:e.balance)==null?void 0:t.number},[e==null?void 0:e.balance]),[d,u]=s.useState(!1),[st,V]=s.useState(null),[p,M]=s.useState(null),[N,z]=s.useState(!1),{data:U,isLoading:rt,isError:it,error:at,refetch:ot}=Rt({enabled:!!(a&&P)}),k=v(t=>t.companies),q=n.jsx(Ft,{variant:"h6",children:"SPEI Out"}),c=rt,f=it,ct=at,mt=s.useMemo(()=>D?k:_?U:[],[i,U,k]),O=()=>{nt(!1),C(0),u(!1),V(null),z(!1),E(null),M(null)},G=t=>{var W,Y,J,Q,X,Z;let o={speiOut:0,internalTransferCompany:0,fee:0},F=0;E(t);const H=(e==null?void 0:e.type)!==yt.CONCENTRATOR;if(_&&H){const j=((W=e==null?void 0:e.commissions)==null?void 0:W.speiOut)||0,h=((Y=e==null?void 0:e.commissions)==null?void 0:Y.fee)||0,m=((J=t==null?void 0:t.transactions)==null?void 0:J.length)*h,S=((Q=t==null?void 0:t.transactions)==null?void 0:Q.reduce((T,St)=>{const Tt=parseFloat(St.amount.replace(/,/g,""));return T+=Tt*(j/100),T},0))||0;F=(m+S).toFixed(2),o={speiOut:S.toFixed(2),internalTransferCompany:0,fee:m.toFixed(2)}}if(D&&H){const j=((X=e==null?void 0:e.commissions)==null?void 0:X.internalTransferCompany)||0,h=((Z=t==null?void 0:t.transactions)==null?void 0:Z.reduce((m,S)=>{const T=parseFloat(S.amount.replace(/,/g,""));return m+=T*(j/100),m},0))||0;F=h.toFixed(2),o={speiOut:0,internalTransferCompany:h.toFixed(2),fee:0}}const K=(parseFloat(B)-I-F).toFixed(2),ht=K<0;V({transactions:(t==null?void 0:t.transactions)||[],concept:t==null?void 0:t.concept,balance:B,origin:t==null?void 0:t.origin,internal:!_,currentBalance:I,commissions:o,insufficient:ht,total:K}),u(!0)},lt=()=>{u(!1)},dt=t=>{u(!1),M(t)},ut=(t,o)=>{o&&(A(o),E(null))},pt=()=>{ot()};s.useEffect(()=>{A(l==null?void 0:l.id)},[l]);const ft=n.jsxs(n.Fragment,{children:[n.jsx($,{alignItems:"flex-end",sx:{py:1,px:3},children:n.jsx(Et,{size:"small",color:"primary",value:i,exclusive:!0,onChange:ut,"aria-label":"Platform",disabled:N,children:r==null?void 0:r.map(t=>n.jsx(Ot,{value:t==null?void 0:t.id,children:t==null?void 0:t.name},t==null?void 0:t.id))})}),et?n.jsx(Pt,{onSuccess:G,setCurrentBalance:C,initialValues:w,selectedAccount:e}):n.jsx(Lt,{accounts:mt||[],onSuccess:G,setCurrentBalance:C,initialValues:w,selectedAccount:e},i)]});return P?n.jsxs(tt,{open:a,handleClose:O,titleElement:q,children:[c&&n.jsx(_t,{}),f&&!c&&n.jsx(Ct,{errorMessage:ct,titleMessage:"Lista de Cuentas",handleButton:()=>pt()}),!f&&!c&&a&&!d&&!p&&n.jsx(y.div,{variants:L().in,style:{display:d?"none":"flex",flex:1,overflow:"hidden",flexDirection:"column"},children:ft}),!f&&!c&&a&&d&&!p&&n.jsx(y.div,{variants:L().in,children:n.jsx(bt,{data:st,onBack:lt,setTransactionLoading:z,transactionLoading:N,onSuccess:dt})}),!f&&!c&&a&&!d&&p&&n.jsx(y.div,{variants:L().in,children:n.jsx(At,{transactions:p,onFinish:O})})]}):n.jsx(tt,{open:a,handleClose:O,titleElement:q,children:n.jsx($,{p:3,children:n.jsx(gt,{titleMessage:"Google Authenticator",errorMessage:"Para realizar esta operación debe activar y configurar el Doble Factor de Autentificación (2FA) desde su perfil."})})})};export{Qt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/SpeiOutForm-C2ddF_HO.js","assets/js/vendor-5lkxkETF.js","assets/js/index-DkbAsBWZ.js","assets/css/build-Bl0dWaDY.css","assets/js/formik.esm-CTTSENmf.js","assets/js/index.esm-gIIytEq8.js","assets/js/AdminDashboardViaboSpei-B1bJP65o.js","assets/js/formatNumber-dGNhWwxT.js","assets/js/formatTime-jCgU2sMR.js","assets/js/matchTypes-mENztEWg.js","assets/js/TextMaxLine-B63DtfW-.js","assets/js/UploadSingleFile-ByYCreVQ.js","assets/js/fade-CViozI82.js","assets/js/transition-anLY3gj9.js","assets/js/viabo-spei-paths-CvU5WLsk.js","assets/js/filterSearch-NGUmCbyG.js","assets/js/usePagination-Xa7qo0UK.js","assets/js/HeaderPage-Bqn_U64p.js","assets/js/RFSelect-DSsw7uR8.js","assets/js/SpeiOutConcentratorForm-mErhfqMO.js","assets/js/SpeiOutResume-BJEmNpoW.js","assets/js/SpeiOutSuccess-DnFJPZbA.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=SpeiOutDrawer-NU8AJ80H.js.map

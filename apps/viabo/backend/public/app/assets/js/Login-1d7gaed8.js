import{r as a,ay as V,f as z,j as D,e as Q,U as W,i as e,az as _,m as $,T as p,S as s,q as w,aA as Y,B as I,l as J,ab as K,aB as k,Q as X,aC as Z,z as ee,c as te,k as se}from"./vendor-5lkxkETF.js";import{u as ie}from"./formik.esm-CTTSENmf.js";import{o as ne}from"./mui-one-time-password-input.es-DECpCfUz.js";import{c as re,a as R}from"./index.esm-gIIytEq8.js";import{A as M,s as S,a as oe,g as b,b as A,c as ae,d as ce,v as le,u as de,M as P,P as ue,F as me}from"./index-DkbAsBWZ.js";import{i as H,m as he}from"./matchTypes-mENztEWg.js";import{A as ge}from"./AlertWithFocus-CbRaRhiM.js";import{v}from"./fade-CViozI82.js";import{F as pe,R as xe}from"./TextMaxLine-B63DtfW-.js";import{R as fe}from"./RFPasswordField-Ceox2ZL5.js";import"./transition-anLY3gj9.js";import"./formatTime-jCgU2sMR.js";import"./UploadSingleFile-ByYCreVQ.js";import"./formatNumber-dGNhWwxT.js";import"./index-GDOudVRk.js";import"./iconBase-jHcAKz16.js";const je=(r={})=>{const[f,t]=a.useState(null),[d,u]=a.useState(!1),[c,m]=a.useState(!1),[l,h]=a.useState(null),g=V([M.USER_MODULES]),i=z(ae,{onSuccess:n=>{t(null);const j=n==null?void 0:n.token,y=D(j),E=(y==null?void 0:y.authenticatorFactors)||!1;E?oe.defaults.headers.common.Authorization=`Bearer ${j}`:S(j),h(j),m(E),u(!0)},onError:n=>{u(!1),S(null),t({message:b(n,"Ocurrio un error inesperado. Intente nuevamente o reportelo al área de sistemas"),code:A(n)})},...r}),x=Q([M.USER_MODULES],ce,{onSuccess:n=>{t(null),u(!1)},onError:n=>{u(!1),S(null),t({message:b(n,"Ocurrio un error inesperado. Intente nuevamente o reportelo al área de sistemas"),code:A(n)})},enabled:!!d,retry:!1});return{...i,setCustomError:t,isError:i.isError||x.isError,isSuccess:i.isSuccess&&x.isSuccess,isLoading:i.isLoading||g===1,error:f??null,token:l,isTwoAuth:c}},ye=(r={})=>{const[f,t]=a.useState(null),d=z(le,r);return{...d,mutate:async(c,m)=>{const{onSuccess:l,onError:h,mutationOptions:g}=m;try{const i=await W.promise(d.mutateAsync(c,g),{pending:"Validando Codigo"});H(l)&&l(i)}catch(i){const x=b(i,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");t(x),H(h)&&h(x),W.error(x,{type:A(i)})}},error:f}},we=({text:r,variant:f,loop:t,...d})=>{const[u,c]=a.useState(""),[m,l]=a.useState(0);return a.useEffect(()=>{const h=setInterval(()=>{m<r.length?(c(g=>g+r[m]),l(g=>g+1)):t&&(c(""),l(0))},100);return()=>clearInterval(h)},[m,r,t]),e.jsx(_,{children:e.jsx($.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{minHeight:"15px"},children:e.jsx(p,{variant:f,...d,children:u})})})};function ve(){const{login:r}=de(),{mutate:f,error:t,isError:d,isLoading:u,isSuccess:c,setCustomError:m,isTwoAuth:l,token:h}=je(),[g,i]=a.useState(!1),[x,n]=a.useState(""),{mutate:j,isLoading:y,error:E,isError:F}=ye(),B=re().shape({email:R().email("Ingrese un correo valido").required("El correo es requerido"),password:R().required("La contraseña es requerida")}),L=ie({initialValues:{email:"",password:""},validationSchema:B,onSubmit:(o,{setSubmitting:Ee})=>{m(null);const q={username:o==null?void 0:o.email,password:o==null?void 0:o.password};f(q)}}),{isSubmitting:T,setSubmitting:G}=L,C=u||T;a.useEffect(()=>{(c||d)&&G(!1),c&&!l&&(r(),i(!1)),c&&l&&i(!0)},[d,c]);const N=o=>{n(o)},O=o=>he(o),U=o=>{j({googleAuthenticatorCode:o,token:h},{onSuccess:()=>{S(h),i(!1),r()},onError:()=>{n(""),S(null)}})};return g?e.jsx(P,{children:e.jsxs(s,{gap:5,p:4,justifyContent:"center",height:1,children:[e.jsxs(s,{children:[e.jsx(w.div,{variants:v().inRight,children:e.jsx(p,{align:"center",variant:"h3",sx:{color:"primary.main",fontWeight:"fontWeightMedium"},children:"Ingresa tu código"})}),e.jsx(w.div,{variants:v().inRight,children:e.jsx(p,{align:"center",variant:"h3",sx:{color:"primary.light",fontWeight:"fontWeightMedium"},children:"de autentificación"})}),e.jsx(s,{justifyContent:"center",alignItems:"center",mt:3,children:e.jsx(Y,{sx:{width:40,height:40,color:F?"error.main":"primary.main"}})})]}),e.jsxs(s,{justifyContent:"center",alignItems:"center",gap:3,children:[e.jsxs(p,{textAlign:"center",variant:"body2",fontWeight:600,sx:{color:"text.secondary",textWrap:"wrap"},children:["Ingresa a la aplicación de"," ",e.jsx(I,{component:"span",color:"primary.main",children:"Google Authenticator"})," ","y escribe el código a continuación"]}),e.jsx(ne,{length:6,value:x,onComplete:U,onChange:N,validateChar:O,sx:{gap:{xs:1.5,sm:2,md:3}},TextFieldsProps:{placeholder:"0",disabled:y,error:F}})]}),y&&e.jsxs(s,{justifyContent:"center",alignItems:"center",gap:3,children:[e.jsx(J,{}),e.jsx(p,{variant:"body2",fontWeight:600,sx:{color:"text.primary",textWrap:"wrap"},children:"Iniciando Sesión..."})]})]})}):e.jsx(P,{children:e.jsxs(s,{spacing:3,p:4,justifyContent:"center",height:1,children:[e.jsxs(s,{children:[e.jsx(w.div,{variants:v().inRight,children:e.jsx(p,{align:"center",variant:"h3",sx:{color:"primary.main",fontWeight:"fontWeightMedium"},children:"Aquí Comienza"})}),e.jsx(w.div,{variants:v().inRight,children:e.jsx(p,{align:"center",variant:"h3",sx:{color:"primary.light",fontWeight:"fontWeightMedium"},children:"tu agilidad en pagos"})})]}),e.jsx(we,{color:"common",text:"¡Es tiempo de transformar tu negocio!",variant:"h6",align:"center"}),t&&e.jsxs(ge,{listenElement:t,sx:{mt:3,textAlign:"initial"},severity:t==null?void 0:t.code,children:[e.jsx(K,{sx:{textAlign:"initial"},children:"Inicio de Sesión"}),t==null?void 0:t.message]}),e.jsx(w.div,{...v().in,children:e.jsx(pe,{formik:L,children:e.jsxs(s,{spacing:2,flex:1,children:[e.jsxs(s,{spacing:1,children:[e.jsx(k,{htmlFor:"email",children:"Email"}),e.jsx(xe,{id:"email",disabled:C,name:"email",placeholder:"usuario@dominio.com",type:"email",fullWidth:!0,InputLabelProps:{shrink:!0}})]}),e.jsxs(s,{spacing:1,children:[e.jsx(k,{htmlFor:"password",children:"Contraseña"}),e.jsx(fe,{id:"password",InputLabelProps:{shrink:!0},disabled:C,name:"password",placeholder:"********",fullWidth:!0})]}),e.jsx(s,{pt:1,children:e.jsx(X,{loading:C,variant:"contained",color:"primary",fullWidth:!0,type:"submit",size:"large",disabled:T,children:"Accesar a mi cuenta"})}),e.jsxs(p,{variant:"body2",fontWeight:600,align:"center",sx:{color:"text.secondary"},children:["¿No tienes una cuenta?  ",e.jsx(Z,{color:"primary",component:ee,to:"/registro",children:"Inscribete."})]})]})})})]})})}const Se="/app/assets/webp/build-BEdJGll8.webp",Ne=()=>{const r=te();return a.useEffect(()=>{r.removeQueries()},[]),e.jsx(ue,{title:"Inicio de Sesión",children:e.jsx(s,{alignItems:"center",justifyContent:"center",minHeight:"100dvH",children:e.jsxs(s,{px:{sm:10,xl:20},width:1,height:1,direction:"row",children:[e.jsxs(s,{flexGrow:1,width:1,height:1,minHeight:"70vh",maxHeight:"90vH",position:"relative",sx:{overflowX:"hidden",overflowY:"auto"},justifyContent:"space-between",children:[e.jsxs(s,{direction:"row",spacing:1,alignItems:"center",px:{xs:5,sm:0},children:[e.jsx(me,{sx:{width:100}}),e.jsx(p,{fontWeight:"600",variant:"subtitle1",children:"Agilidad en pagos"})]}),e.jsx(I,{flexGrow:1}),e.jsx(s,{flex:1,px:{xs:0,sm:5,xl:15},children:e.jsx(ve,{})})]}),e.jsx(s,{width:1,justifyContent:"center",height:1,flexGrow:1,sx:{display:{xs:"none",sm:"none",lg:"flex"}},children:e.jsx(I,{component:se.LazyLoadImage,placeholderSrc:"https://zone-assets-api.vercel.app/assets/img_placeholder.svg",wrapperClassName:"wrapper",effect:"blur",height:1,maxHeight:"90vH",sx:{objectFit:"fill"},borderRadius:4,src:Se})})]})})})};export{Ne as default};
//# sourceMappingURL=Login-1d7gaed8.js.map

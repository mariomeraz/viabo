import{c as A,f as E,U as B,s as M,dR as T,r as C,i as e,dO as N,dP as F,dQ as O,dS as o,dT as P,B as Q,T as p,S as I,Q as W,K as _,e0 as k,P as c}from"./vendor-5lkxkETF.js";import{K as D,g as z,b as G,S as K}from"./index-DkbAsBWZ.js";import{f as y}from"./formatNumber-dGNhWwxT.js";import{t as L,C as S}from"./useToggleStatusCard-DsdEWGTJ.js";import{g as U}from"./cardTypes-DiZXL2sx.js";import"./cardsAdapter-CnGv3jFq.js";import"./formatTime-jCgU2sMR.js";import"./matchTypes-mENztEWg.js";import"./cardMovementsAdapter-DwJrnLuP.js";import"./AmexLogo-BNm7u8Au.js";import"./CarnetLogo-CFGRKXQt.js";import"./MasterCardLogo-C26mw1FM.js";import"./VisaLogo-BXtVVQaT.js";const $=(r,i,t,g)=>{var m,x;let d;return g?d={originCardId:r,destinationCards:[{cardId:(m=i==null?void 0:i.card)==null?void 0:m.value.toString(),concept:(t==null?void 0:t.toString())||"",amount:parseFloat((i==null?void 0:i.amount.toString())===""?"0":(x=i==null?void 0:i.amount)==null?void 0:x.toString().replace(/,/g,"")).toString()}]}:d={originCardId:r,destinationCards:i==null?void 0:i.map(n=>{var u,s,h;return{cardId:(s=(u=n==null?void 0:n.card)==null?void 0:u.value)==null?void 0:s.toString(),concept:(t==null?void 0:t.toString())||"",amount:parseFloat((n==null?void 0:n.amount.toString())===""?"0":(h=n==null?void 0:n.amount)==null?void 0:h.toString().replace(/,/g,"")).toString()}})},{cardId:d==null?void 0:d.originCardId,data:D(d)}},H=(r={})=>{const i=A(),t=E(L,r);return{...t,transaction:async(d,m)=>{const{onSuccess:x,onError:n,mutationOptions:u}=m;try{await B.promise(t.mutateAsync(d,u),{pending:"Procesando Transferencia ...",success:{render({data:s}){return i.fetchQuery([S.TRANSIT_BALANCE]),i.invalidateQueries([S.CARD_INFO,s==null?void 0:s.cardId]),i.fetchQuery([S.CARD_MOVEMENTS,s==null?void 0:s.cardId]),i.fetchQuery([S.MAIN_CARD]),x(s),"Se realizo la transferencia con éxito"}}})}catch(s){const h=z(s,"No se puede realizar esta operación en este momento. Intente nuevamente o reporte a sistemas");n(h),B.error(h,{type:G(s)})}}}},b=M(T)(({theme:r})=>({"& td":{paddingTop:r.spacing(.5),paddingBottom:r.spacing(.5)}})),V=({data:r,onBack:i,setTransactionLoading:t,transactionLoading:g,onClose:d})=>{const{transaction:m,isLoading:x}=H(),n=C.useMemo(()=>(r!=null&&r.isGlobal?[r==null?void 0:r.transactions]:r==null?void 0:r.transactions)||[],[r]),u=C.useMemo(()=>(parseFloat(r==null?void 0:r.balance)-(r==null?void 0:r.currentBalance)).toFixed(2)||0,[r]),s=()=>{const{cardOriginId:l,transactions:a,isGlobal:j,concept:f}=r,R=$(l,a,f,j);t(!0),m(R,{onSuccess:()=>{d()},onError:()=>{t(!1)}})},h=C.useMemo(()=>U(r==null?void 0:r.paymentProcessor),[r]),v=h==null?void 0:h.component;return e.jsxs(e.Fragment,{children:[e.jsx(K,{children:e.jsx(N,{sx:{minWidth:200},children:e.jsxs(F,{children:[e.jsx(O,{sx:{borderBottom:l=>`solid 1px ${l.palette.divider}`},children:e.jsxs(T,{children:[e.jsx(o,{width:40,children:"#"}),e.jsx(o,{align:"left",children:"Movimiento"}),e.jsx(o,{align:"right",children:"Monto"})]})}),e.jsxs(P,{children:[n==null?void 0:n.map((l,a)=>{var j;return e.jsxs(T,{sx:{borderBottom:f=>`solid 1px ${f.palette.divider}`},children:[e.jsx(o,{children:a+1}),e.jsx(o,{align:"left",children:e.jsxs(Q,{sx:{maxWidth:200},children:[e.jsx(p,{variant:"subtitle2",children:((j=l==null?void 0:l.card)==null?void 0:j.cardUserNumber)||"Cuenta Global"}),e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:l==null?void 0:l.concept})]})}),e.jsx(o,{align:"right",children:y(l==null?void 0:l.amount)})]},a)}),e.jsxs(b,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsxs(I,{flexDirection:"row",gap:1,alignItems:"center",justifyContent:"flex-end",children:[e.jsx(p,{children:"Saldo Disponible"}),h&&e.jsx(v,{sx:{width:30,height:30}})]})}),e.jsx(o,{align:"right",width:120,children:e.jsx(p,{children:y(r==null?void 0:r.balance)})})]}),e.jsxs(b,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsx(p,{variant:"h6",children:"Total a dispersar"})}),e.jsx(o,{align:"right",width:120,children:e.jsx(p,{variant:"h6",sx:{color:"error.main"},children:y(-(r==null?void 0:r.currentBalance))})})]}),e.jsxs(b,{children:[e.jsx(o,{colSpan:1}),e.jsx(o,{align:"right",children:e.jsx(p,{children:"Total después de movimiento"})}),e.jsx(o,{align:"right",width:140,children:e.jsx(p,{children:y(u)})})]})]})]})})}),e.jsxs(I,{sx:{p:3},spacing:3,children:[e.jsx(W,{size:"large",onClick:s,loading:x||g,variant:"contained",color:"primary",fullWidth:!0,type:"submit",sx:{fontWeight:"bold"},children:"Realizar"}),(!x||!g)&&e.jsx(_,{onClick:i,variant:"outlined",color:"inherit",fullWidth:!0,startIcon:e.jsx(k,{}),children:"Regresar"})]})]})};V.propTypes={data:c.shape({balance:c.any,cardOriginId:c.any,paymentProcessor:c.any,currentBalance:c.any,isGlobal:c.any,transactions:c.any,concept:c.any}),onBack:c.any,onClose:c.func,setTransactionLoading:c.func,transactionLoading:c.any};export{V as default};
//# sourceMappingURL=ResumeTransactionForm-0JEbCqgi.js.map

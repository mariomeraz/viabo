{"version":3,"mappings":"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","names":["useEnableTwoAuth","options","twoAuth","useMutation","enableTwoAuth","formData","onSuccess","onError","mutationOptions","data","toast","isFunction","error","errorFormatted","getErrorAPI","getNotificationTypeByErrorCode","useFindGoogleAuthenticatorQR","customError","setCustomError","useState","query","useQuery","AUTHENTICATION_KEYS","signal","getGoogleAuthQRCode","useEffect","errorMessage","GoogleAuth","OverlayStyle","styled","theme","top","left","right","bottom","zIndex","position","backgroundColor","palette","mode","alpha","primary","main","secondary","TwoAuthForm","Lodable","lazy","TwoAuthDrawer","setOpenTwoAuthConfig","useUiSharedStore","state","openTwoAuthConfig","mutateTwoAuth","isLoading","isError","refetch","enabled","setTwoAuth","useAuth","isSuccess","useMemo","handleClose","matches","useResponsive","handleDrawerClose","event","type","key","handleFinish","jsxs","Drawer","borderRadius","width","sm","lg","xl","keepMounted","jsx","RequestLoadingComponent","p","Stack","px","py","IconButtonAnimate","Close","Divider","ErrorRequestPage","Fragment","minHeight","mb","Typography","color","Box","height","mx","display","background","paper","Avatar"],"sources":["../../../../../frontend/src/app/authentication/hooks/useEnableTwoAuth.js","../../../../../frontend/src/app/authentication/hooks/useFindGoogleAuthenticatorQR.js","../../../../../frontend/src/shared/assets/icons/google-auth.svg","../../../../../frontend/src/app/authentication/components/TwoAuthDrawer.jsx"],"sourcesContent":["import { useMutation } from '@tanstack/react-query'\r\nimport { toast } from 'react-toastify'\r\n\r\nimport { enableTwoAuth } from '../services'\r\n\r\nimport { getErrorAPI, getNotificationTypeByErrorCode } from '@/shared/interceptors'\r\nimport { isFunction } from '@/shared/utils'\r\n\r\nexport const useEnableTwoAuth = (options = {}) => {\r\n  const twoAuth = useMutation(enableTwoAuth, options)\r\n  const mutate = async (formData, options) => {\r\n    const { onSuccess, onError, mutationOptions } = options\r\n\r\n    try {\r\n      const data = await toast.promise(twoAuth.mutateAsync(formData, mutationOptions), {\r\n        pending: 'Configurando dispositivo ...'\r\n      })\r\n      isFunction(onSuccess) && onSuccess(data)\r\n    } catch (error) {\r\n      const errorFormatted = getErrorAPI(\r\n        error,\r\n        `No se puede realizar esta operaciÃ³n en este momento. Intente nuevamente o reporte a sistemas`\r\n      )\r\n      isFunction(onError) && onError(errorFormatted)\r\n      toast.error(errorFormatted, {\r\n        type: getNotificationTypeByErrorCode(error)\r\n      })\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...twoAuth,\r\n    mutate\r\n  }\r\n}\r\n","import { useEffect, useState } from 'react'\r\n\r\nimport { useQuery } from '@tanstack/react-query'\r\n\r\nimport { AUTHENTICATION_KEYS } from '../adapters'\r\nimport { getGoogleAuthQRCode } from '../services'\r\n\r\nimport { getErrorAPI } from '@/shared/interceptors'\r\n\r\nexport const useFindGoogleAuthenticatorQR = (options = {}) => {\r\n  const [customError, setCustomError] = useState(null)\r\n\r\n  const query = useQuery({\r\n    queryKey: [AUTHENTICATION_KEYS.GOOGLE_AUTH_QR],\r\n    queryFn: ({ signal }) => getGoogleAuthQRCode(),\r\n    refetchOnWindowFocus: false,\r\n    retry: false,\r\n    staleTime: 300000,\r\n    ...options\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (query?.isError) {\r\n      const errorMessage = getErrorAPI(\r\n        query.error,\r\n        'No se puede obtener el QR de Google Authenticator. Intente nuevamente o reporte a sistemas'\r\n      )\r\n      setCustomError(errorMessage)\r\n    }\r\n  }, [query.isError, query.error])\r\n\r\n  return {\r\n    ...query,\r\n    error: customError || null\r\n  }\r\n}\r\n","export default \"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20id='Layer_1'%20x='0'%20y='0'%20style='enable-background:new%200%200%202481.9%202481.9'%20version='1.1'%20viewBox='0%200%202481.9%202481.9'%3e%3cstyle%3e.st0{fill:%23616161}.st1{fill:%239e9e9e}.st3{fill:%23212121;fill-opacity:.1}.st6{fill:%23bdbdbd}%3c/style%3e%3cg%20transform='translate(-27%20-27)'%3e%3ccircle%20cx='1268'%20cy='1268'%20r='1241'%20class='st0'/%3e%3cpath%20d='M1268%202057.7c-436.2%200-789.7-353.5-789.7-789.7%200-436.2%20353.5-789.7%20789.7-789.7%20218%200%20415.4%2088.4%20558.4%20231.3l319.1-319.1C1920.9%20165.9%201610.6%2027%201268%2027%20582.6%2027%2027%20582.6%2027%201268s555.6%201241%201241%201241c342.7%200%20652.9-138.9%20877.6-363.4l-319.1-319.1c-143.1%20142.8-340.5%20231.2-558.5%20231.2z'%20class='st1'/%3e%3cpath%20d='M2057.7%201268h-394.9c0-218-176.8-394.9-394.9-394.9S873.1%201049.9%20873.1%201268c0%20106.2%2042%20202.5%20110.3%20273.6l-.3.3%20488.9%20488.9.1.1c337.2-90%20585.6-397.4%20585.6-762.9z'%20style='fill:%23424242'/%3e%3cpath%20d='M2508.9%201268h-451.3c0%20365.5-248.5%20672.9-585.5%20762.9l348.5%20348.5c408-203.3%20688.3-624.6%20688.3-1111.4z'%20class='st0'/%3e%3cpath%20d='M1268%202494.8C585%202494.8%2031%201943%2027.1%201260.9c0%202.4-.1%204.7-.1%207.1%200%20685.4%20555.6%201241%201241%201241s1241-555.6%201241-1241c0-2.4-.1-4.7-.1-7.1-3.9%20682.1-558%201233.9-1240.9%201233.9z'%20class='st3'/%3e%3cpath%20d='m1472.2%202030.9%2011%2011c331.4-93.6%20574.5-398.2%20574.5-759.8V1268c0%20365.5-248.5%20672.9-585.5%20762.9z'%20style='fill:%23fff;fill-opacity:5.000000e-02'/%3e%3cpath%20d='M2283.355%201155.155h-1015.4c-62.3%200-112.8%2050.5-112.8%20112.8s50.5%20112.8%20112.8%20112.8h1015.3c62.3%200%20112.8-50.5%20112.8-112.8.1-62.3-50.4-112.8-112.7-112.8z'%20class='st1'/%3e%3cpath%20d='M2046.9%20918.7H1031.5c-62.3%200-112.8%2050.5-112.8%20112.8s50.5%20112.8%20112.8%20112.8h1015.3c62.3%200%20112.8-50.5%20112.8-112.8.1-62.3-50.4-112.8-112.7-112.8z'%20style='opacity:.5;fill:%23bdbdbd;enable-background:new'%20transform='translate(236.455%20236.455)'/%3e%3ccircle%20cx='252.6'%20cy='1268'%20r='84.6'%20class='st6'/%3e%3ccircle%20cx='1268'%20cy='252.6'%20r='84.6'%20class='st6'/%3e%3ccircle%20cx='1268'%20cy='2283.3'%20r='84.6'%20class='st6'/%3e%3ccircle%20cx='548.8'%20cy='550'%20r='84.6'%20class='st6'/%3e%3ccircle%20cx='548.8'%20cy='1987.2'%20r='84.6'%20class='st6'/%3e%3ccircle%20cx='1987.2'%20cy='1987.2'%20r='84.6'%20style='fill:%23757575'/%3e%3cpath%20d='M1268%201169.3h1015.3c59.9%200%20108.9%2046.8%20112.4%20105.8.1-2.4.4-4.7.4-7.1%200-62.3-50.5-112.8-112.8-112.8H1268c-62.3%200-112.8%2050.5-112.8%20112.8%200%202.4.1%204.7.4%207.1%203.5-59%2052.4-105.8%20112.4-105.8z'%20style='fill:%23fff;fill-opacity:.2'/%3e%3cpath%20d='M2395.7%201275c-3.7%2058.9-52.6%20105.8-112.4%20105.8H1268c-59.9%200-108.9-46.8-112.4-105.8-.3%202.4-.4%204.7-.4%207%200%2062.3%2050.5%20112.8%20112.8%20112.8h1015.3c62.3%200%20112.8-50.5%20112.8-112.8%200-2.3-.1-4.6-.4-7z'%20style='fill:%23212121;fill-opacity:.2'/%3e%3cpath%20d='M1268%20492.4c218%200%20415.4%2088.4%20558.4%20231.3l326-326.2c-2.4-2.4-4.7-4.8-7-7.1l-319%20319.1c-143-142.9-340.4-231.3-558.4-231.3-436.2%200-789.7%20353.5-789.7%20789.7%200%202.4.1%204.7.1%207.1%203.8-432.9%20355.8-782.6%20789.6-782.6z'%20class='st3'/%3e%3cradialGradient%20id='SVGID_1_'%20cx='706.725'%20cy='1774.029'%20r='.998'%20gradientTransform='matrix(2481.9333%200%200%20-2481.9333%20-1753654.125%204403410.5)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20style='stop-color:%23fff;stop-opacity:.1'/%3e%3cstop%20offset='1'%20style='stop-color:%23fff;stop-opacity:0'/%3e%3c/radialGradient%3e%3ccircle%20cx='1268'%20cy='1268'%20r='1241'%20style='fill:url(%23SVGID_1_)'/%3e%3c/g%3e%3c/svg%3e\"","import { lazy, useMemo } from 'react'\r\n\r\nimport { Close } from '@mui/icons-material'\r\nimport { Avatar, Box, Divider, Drawer, Stack, Typography, alpha, styled } from '@mui/material'\r\n\r\nimport { useEnableTwoAuth, useFindGoogleAuthenticatorQR } from '../hooks'\r\n\r\nimport GoogleAuth from '@/shared/assets/icons/google-auth.svg'\r\nimport { IconButtonAnimate } from '@/shared/components/animate'\r\nimport { RequestLoadingComponent } from '@/shared/components/loadings'\r\nimport { Lodable } from '@/shared/components/lodables'\r\nimport { ErrorRequestPage } from '@/shared/components/notifications'\r\nimport { useAuth } from '@/shared/hooks'\r\nimport { useUiSharedStore } from '@/shared/store'\r\nimport { useResponsive } from '@/theme/hooks'\r\n\r\nconst OverlayStyle = styled('div')(({ theme }) => ({\r\n  top: 0,\r\n  left: 0,\r\n  right: 0,\r\n  bottom: 0,\r\n  zIndex: 8,\r\n  position: 'absolute',\r\n  backgroundColor:\r\n    theme.palette.mode === 'light' ? alpha(theme.palette.primary.main, 0.7) : alpha(theme.palette.secondary.main, 0.5)\r\n}))\r\n\r\nconst TwoAuthForm = Lodable(lazy(() => import('./TwoAuthForm')))\r\n\r\nconst TwoAuthDrawer = () => {\r\n  const setOpenTwoAuthConfig = useUiSharedStore(state => state.setOpenTwoAuthConfig)\r\n  const openTwoAuthConfig = useUiSharedStore(state => state.openTwoAuthConfig)\r\n\r\n  const mutateTwoAuth = useEnableTwoAuth()\r\n  const { data, isLoading, error, isError, refetch } = useFindGoogleAuthenticatorQR({ enabled: !!openTwoAuthConfig })\r\n\r\n  const { setTwoAuth } = useAuth()\r\n  const isSuccess = useMemo(() => mutateTwoAuth.isSuccess, [mutateTwoAuth.isSuccess])\r\n\r\n  const handleClose = () => {\r\n    setOpenTwoAuthConfig(false)\r\n    if (isSuccess) {\r\n      setTwoAuth(true)\r\n    }\r\n  }\r\n\r\n  const matches = useResponsive('down', 'md')\r\n\r\n  const handleDrawerClose = event => {\r\n    if (event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\r\n      return\r\n    }\r\n    handleClose()\r\n  }\r\n\r\n  const handleFinish = () => {\r\n    setOpenTwoAuthConfig(false)\r\n    setTwoAuth(true)\r\n  }\r\n\r\n  return (\r\n    <Drawer\r\n      keepMounted={false}\r\n      anchor={matches ? 'bottom' : 'right'}\r\n      sx={{\r\n        '& .MuiPaper-root.MuiDrawer-paper': {\r\n          borderRadius: `${!matches ? '10px 0px 0px 10px' : 'none'}`,\r\n          width: { sm: '100%', lg: '40%', xl: '30%' }\r\n        }\r\n      }}\r\n      open={openTwoAuthConfig}\r\n      onClose={handleDrawerClose}\r\n      ModalProps={{\r\n        keepMounted: false\r\n      }}\r\n    >\r\n      {isLoading && <RequestLoadingComponent sx={{ p: 3 }} />}\r\n      {isError && !isLoading && (\r\n        <Stack gap={2}>\r\n          <Stack>\r\n            <Stack flexDirection={'row'} justifyContent={'flex-end'} alignItems={'flex-end'} sx={{ px: 2, py: 1 }}>\r\n              <IconButtonAnimate aria-label=\"close\" size=\"medium\" onClick={handleClose}>\r\n                <Close width={20} height={20} fontSize=\"inherit\" color=\"primary\" />\r\n              </IconButtonAnimate>\r\n            </Stack>\r\n            <Divider />\r\n          </Stack>\r\n          <ErrorRequestPage\r\n            sx={{ p: 3 }}\r\n            errorMessage={error}\r\n            titleMessage={'Google Authenticator'}\r\n            handleButton={() => refetch()}\r\n          />\r\n        </Stack>\r\n      )}\r\n\r\n      {!isError && !isLoading && openTwoAuthConfig && (\r\n        <>\r\n          <Stack position={'relative'} sx={{ minHeight: 100, mb: 3 }}>\r\n            <OverlayStyle />\r\n            <Stack\r\n              direction=\"row\"\r\n              alignItems=\"center\"\r\n              justifyContent=\"space-between\"\r\n              sx={{ zIndex: 11, px: 2.5, py: 2 }}\r\n            >\r\n              <Typography variant=\"h5\" color={'white'}>\r\n                Google Authenticator\r\n              </Typography>\r\n\r\n              <div>\r\n                <IconButtonAnimate aria-label=\"close\" size=\"medium\" onClick={handleClose}>\r\n                  <Close width={20} height={20} fontSize=\"inherit\" color=\"primary\" sx={{ color: 'white' }} />\r\n                </IconButtonAnimate>\r\n              </div>\r\n            </Stack>\r\n            <Box\r\n              component=\"span\"\r\n              sx={{\r\n                width: 144,\r\n                height: 62,\r\n                zIndex: 10,\r\n                left: 0,\r\n                right: 0,\r\n                bottom: -26,\r\n                mx: 'auto',\r\n                position: 'absolute',\r\n                display: 'inline-block',\r\n\r\n                color: theme => theme.palette.background.paper\r\n              }}\r\n            >\r\n              <svg height=\"62\" viewBox=\"0 0 144 62\" width=\"144\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path\r\n                  d=\"m111.34 23.88c-10.62-10.46-18.5-23.88-38.74-23.88h-1.2c-20.24 0-28.12 13.42-38.74 23.88-7.72 9.64-19.44 11.74-32.66 12.12v26h144v-26c-13.22-.38-24.94-2.48-32.66-12.12z\"\r\n                  fill=\"currentColor\"\r\n                  fillRule=\"evenodd\"\r\n                />\r\n              </svg>\r\n            </Box>\r\n\r\n            <Avatar\r\n              alt={'google-authenticator'}\r\n              sx={{\r\n                width: 60,\r\n                height: 60,\r\n                zIndex: 11,\r\n                left: 0,\r\n                right: 0,\r\n                bottom: -30,\r\n                mx: 'auto',\r\n                position: 'absolute'\r\n              }}\r\n              src={GoogleAuth}\r\n            />\r\n          </Stack>\r\n          <TwoAuthForm onFinish={handleFinish} mutateTwoAuth={mutateTwoAuth} googleCode={data} />\r\n        </>\r\n      )}\r\n    </Drawer>\r\n  )\r\n}\r\n\r\nexport default TwoAuthDrawer\r\n"],"file":"assets/js/TwoAuthDrawer-akzTv99P.js"}
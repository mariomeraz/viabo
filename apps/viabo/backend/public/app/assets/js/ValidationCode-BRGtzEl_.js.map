{"version":3,"file":"ValidationCode-BRGtzEl_.js","sources":["../../../../../frontend/src/shared/assets/img/mail.svg","../../../../../frontend/src/app/business/commerce/components/process/ValidationCode.jsx"],"sourcesContent":["export default \"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='570'%20height='511.675'%20data-name='Layer%201'%3e%3cpath%20fill='%233f3d56'%20d='M880%20389.837a.997.997%200%200%201-.572-.179L602.87%20197.055a5.015%205.015%200%200%200-5.729.01L322.574%20389.655a1%201%200%200%201-1.148-1.637l274.567-192.592a7.022%207.022%200%200%201%208.02-.013L880.57%20388.017a1%201%200%200%201-.572%201.82Z'%20style='--darkreader-inline-fill:%232e2d42'%20transform='translate(-315%20-194.163)'/%3e%3cpath%20fill='%23e6e6e6'%20d='M23.264%20202.502%20285.276%208.319l264%20208-250.5%20148.5-136-31L23.264%20202.502z'%20style='--darkreader-inline-fill:%23222527'/%3e%3cpath%20fill='%23661fff'%20d='M489.256%20650.704h-129.44a6.047%206.047%200%201%201%200-12.095h129.44a6.047%206.047%200%201%201%200%2012.095Z'%20style='--darkreader-inline-fill:%233800bc'%20transform='translate(-315%20-194.163)'/%3e%3cpath%20fill='%23661fff'%20d='M406.256%20624.704h-46.44a6.047%206.047%200%201%201%200-12.095h46.44a6.047%206.047%200%201%201%200%2012.095Z'%20style='--darkreader-inline-fill:%23702bff'%20transform='translate(-315%20-194.163)'/%3e%3cpath%20fill='%23fff'%20d='M603.96%20504.822a7.564%207.564%200%200%201-2.869-.562l-161.59-67.049V227.337a7.008%207.008%200%200%201%207-7h310a7.008%207.008%200%200%201%207%207v210.02l-.305.13-156.28%2066.74a7.616%207.616%200%200%201-2.956.595Z'%20style='--darkreader-inline-fill:%23131516'%20transform='translate(-315%20-194.163)'/%3e%3cpath%20fill='%233f3d56'%20d='M603.96%20505.322a8.072%208.072%200%200%201-3.06-.6L439%20437.546V227.337a7.509%207.509%200%200%201%207.5-7.5h310a7.509%207.509%200%200%201%207.5%207.5v210.35l-156.888%2067a8.11%208.11%200%200%201-3.152.635ZM441%20436.209l160.663%2066.665a6.118%206.118%200%200%200%204.668-.028l155.67-66.479v-209.03a5.507%205.507%200%200%200-5.5-5.5h-310a5.507%205.507%200%200%200-5.5%205.5Z'%20style='--darkreader-inline-fill:%232e2d42'%20transform='translate(-315%20-194.163)'/%3e%3cpath%20fill='%233f3d56'%20d='M878%20387.837h-.2L763%20436.857l-157.07%2067.07a5.066%205.066%200%200%201-3.88.02L440%20436.717l-117.62-48.8-.18-.08h-.2a7.008%207.008%200%200%200-7%207v304a7.008%207.008%200%200%200%207%207h556a7.008%207.008%200%200%200%207-7v-304a7.008%207.008%200%200%200-7-7Zm5%20311a5.002%205.002%200%200%201-5%205H322a5.002%205.002%200%200%201-5-5v-304a5.011%205.011%200%200%201%204.81-5L440%20438.877l161.28%2066.92a7.12%207.12%200%200%200%205.44-.03L763%20439.027l115.2-49.19a5.016%205.016%200%200%201%204.8%205Z'%20style='--darkreader-inline-fill:%232e2d42'%20transform='translate(-315%20-194.163)'/%3e%3cpath%20fill='%23661fff'%20d='M602.345%20445.31a27.499%2027.499%200%200%201-16.546-5.497l-.296-.222-62.31-47.707a27.683%2027.683%200%201%201%2033.673-43.95l40.36%2030.948%2095.379-124.386a27.682%2027.682%200%200%201%2038.813-5.124l-.593.805.608-.793a27.714%2027.714%200%200%201%205.124%2038.813L624.369%20434.506a27.694%2027.694%200%200%201-22.024%2010.804Z'%20style='--darkreader-inline-fill:%233800bc'%20transform='translate(-315%20-194.163)'/%3e%3c/svg%3e\"","import { useEffect, useState } from 'react'\r\n\r\nimport PropTypes from 'prop-types'\r\n\r\nimport { Box, CircularProgress, Divider, Link, Stack, Typography } from '@mui/material'\r\nimport { MuiOtpInput } from 'mui-one-time-password-input'\r\n\r\nimport { useFindCommerceToken } from '@/app/business/commerce/hooks'\r\nimport { PROCESS_LIST, PROCESS_LIST_STEPS } from '@/app/business/commerce/services'\r\nimport { propTypesStore } from '@/app/business/commerce/store'\r\nimport { useSendValidationCode, useValidateCode } from '@/app/business/shared/hooks'\r\nimport mail from '@/shared/assets/img/mail.svg'\r\nimport { matchIsNumeric } from '@/shared/utils'\r\n\r\nValidationCode.propTypes = {\r\n  store: PropTypes.shape(propTypesStore)\r\n}\r\n\r\nfunction ValidationCode({ store }) {\r\n  const { lastProcess, setActualProcess, setLastProcess, setToken, token, resume } = store\r\n  const { info } = lastProcess\r\n  const { mutate: sendValidationCode, isLoading: isSendingCode } = useSendValidationCode()\r\n  const { mutate: validateCode, isLoading: isValidatingCode, isError: isErrorValidatingCode, reset } = useValidateCode()\r\n  const { data: tokenData, isError } = useFindCommerceToken(info?.email, {\r\n    enabled: Boolean(info?.email)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (tokenData) {\r\n      setToken(tokenData?.token)\r\n    }\r\n  }, [tokenData])\r\n\r\n  const [otp, setOtp] = useState('')\r\n\r\n  const handleChange = newValue => {\r\n    setOtp(newValue)\r\n    reset()\r\n  }\r\n\r\n  const validateChar = value => matchIsNumeric(value)\r\n\r\n  const handleComplete = value => {\r\n    validateCode(\r\n      { verificationCode: value, token },\r\n      {\r\n        onSuccess: () => {\r\n          if (resume?.step) {\r\n            setActualProcess(\r\n              PROCESS_LIST_STEPS.find(process => process.step === resume?.step)?.name || PROCESS_LIST.SERVICES_SELECTION\r\n            )\r\n          } else {\r\n            setActualProcess(PROCESS_LIST.SERVICES_SELECTION)\r\n          }\r\n          setLastProcess()\r\n        },\r\n        onError: () => {\r\n          setOtp('')\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  const handleResendCode = () => {\r\n    sendValidationCode({ token: tokenData?.token })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        sx={{\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          my: 4\r\n        }}\r\n      >\r\n        <img className=\"animate__animated animate__pulse\" src={mail} width=\"25%\" alt=\"Sent Mail\" />\r\n      </Box>\r\n      <Typography variant=\"h4\" color=\"textPrimary\" align=\"center\">\r\n        Verificación de Cuenta\r\n      </Typography>\r\n\r\n      <Typography\r\n        paragraph\r\n        sx={{ mb: 4, mt: 2 }}\r\n        align=\"center\"\r\n        variant=\"body2\"\r\n        color={'text.secondary'}\r\n        whiteSpace=\"pre-line\"\r\n      >\r\n        Enviamos un correo electrónico a {info?.email} con el código de verificacion de tu cuenta, ingrese el código en\r\n        el cuadro a continuación para verificar su cuenta.\r\n      </Typography>\r\n      <MuiOtpInput\r\n        length={6}\r\n        value={otp}\r\n        onComplete={handleComplete}\r\n        onChange={handleChange}\r\n        validateChar={validateChar}\r\n        sx={{ gap: { xs: 1.5, sm: 2, md: 3 } }}\r\n        TextFieldsProps={{ placeholder: '-', error: isErrorValidatingCode, disabled: isValidatingCode }}\r\n      />\r\n      {Boolean(isErrorValidatingCode) && (\r\n        <Box mt={1}>\r\n          <Typography variant={'caption'} color={'error'}>\r\n            Código incorrecto\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n      <Box mb={5}>\r\n        <Divider sx={{ my: 4 }}>\r\n          <Stack direction={'row'} spacing={1} justifyContent={'center'}>\r\n            {isSendingCode ? (\r\n              <CircularProgress wid sx={{ mx: 3 }} />\r\n            ) : (\r\n              <>\r\n                <Typography variant={'body2'}>¿No tengo un código?</Typography>\r\n                <Link underline={'hover'} sx={{ cursor: 'pointer' }} onClick={handleResendCode}>\r\n                  <Typography variant={'body2'} color={'primary'}>\r\n                    Reenviar código\r\n                  </Typography>\r\n                </Link>\r\n              </>\r\n            )}\r\n          </Stack>\r\n        </Divider>\r\n      </Box>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ValidationCode\r\n"],"names":["mail","ValidationCode","propTypes","store","PropTypes","shape","propTypesStore","lastProcess","setActualProcess","setLastProcess","setToken","token","resume","info","mutate","sendValidationCode","isLoading","isSendingCode","useSendValidationCode","validateCode","isValidatingCode","isError","isErrorValidatingCode","reset","useValidateCode","data","tokenData","useFindCommerceToken","email","enabled","Boolean","useEffect","otp","setOtp","useState","handleChange","newValue","validateChar","matchIsNumeric","value","handleComplete","verificationCode","onSuccess","step","PROCESS_LIST_STEPS","find","process","name","PROCESS_LIST","SERVICES_SELECTION","onError","handleResendCode","jsxs","Fragment","jsx","Box","display","flexDirection","alignItems","justifyContent","my","Typography","mb","mt","MuiOtpInput","gap","xs","sm","md","placeholder","error","disabled","Divider","Stack","CircularProgress","mx","Link","cursor"],"mappings":"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"}
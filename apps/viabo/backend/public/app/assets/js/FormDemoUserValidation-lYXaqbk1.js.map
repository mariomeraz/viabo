{"version":3,"file":"FormDemoUserValidation-lYXaqbk1.js","sources":["../../../../../frontend/src/app/business/viabo-card/register-cards/components/FormDemoUserValidation.jsx"],"sourcesContent":["import { useState } from 'react'\r\n\r\nimport { Box, Button, CircularProgress, Divider, Link, Stack, Typography } from '@mui/material'\r\nimport { MuiOtpInput } from 'mui-one-time-password-input'\r\n\r\nimport { useSendValidationCode, useValidateCode } from '@/app/business/shared/hooks'\r\nimport { CARD_ASSIGN_PROCESS_LIST } from '@/app/business/viabo-card/register-cards/services'\r\nimport { useCardUserAssign } from '@/app/business/viabo-card/register-cards/store'\r\nimport { LogoSphere } from '@/shared/components/images'\r\nimport { axios } from '@/shared/interceptors'\r\nimport { matchIsNumeric } from '@/shared/utils'\r\n\r\nexport default function FormDemoUserValidation() {\r\n  const setStep = useCardUserAssign(state => state.setStepAssignRegister)\r\n  const user = useCardUserAssign(state => state.user)\r\n  const token = useCardUserAssign(state => state.token)\r\n  const [otp, setOtp] = useState('')\r\n  const { mutate: sendValidationCode, isLoading: isSendingCode } = useSendValidationCode()\r\n  const { mutate: validateCode, isLoading: isValidatingCode, isError: isErrorValidatingCode, reset } = useValidateCode()\r\n\r\n  const handleChange = newValue => {\r\n    setOtp(newValue)\r\n    reset()\r\n  }\r\n\r\n  const validateChar = (value, index) => matchIsNumeric(value)\r\n\r\n  const handleComplete = value => {\r\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`\r\n    validateCode(\r\n      { verificationCode: value, token },\r\n      {\r\n        onSuccess: () => {\r\n          setStep(CARD_ASSIGN_PROCESS_LIST.CARD_REGISTER)\r\n        },\r\n        onError: () => {\r\n          setOtp('')\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  const handleResendCode = () => {\r\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`\r\n    sendValidationCode()\r\n  }\r\n\r\n  return (\r\n    <Stack>\r\n      <LogoSphere />\r\n\r\n      <Typography variant=\"h4\" color=\"textPrimary\" align=\"center\">\r\n        Estamos a un paso de validar tu identidad\r\n      </Typography>\r\n\r\n      <Typography\r\n        paragraph\r\n        sx={{ mb: 4 }}\r\n        align=\"center\"\r\n        variant=\"body2\"\r\n        color={'text.secondary'}\r\n        whiteSpace=\"pre-line\"\r\n      >\r\n        Revisa tu correo electrónico {user?.email || '-'} e ingresa el código de verificación.\r\n      </Typography>\r\n      <MuiOtpInput\r\n        length={6}\r\n        value={otp}\r\n        onComplete={handleComplete}\r\n        onChange={handleChange}\r\n        validateChar={validateChar}\r\n        sx={{ gap: { xs: 1.5, sm: 2, md: 3 } }}\r\n        TextFieldsProps={{ placeholder: '-', error: isErrorValidatingCode, disabled: isValidatingCode }}\r\n      />\r\n      {Boolean(isErrorValidatingCode) && (\r\n        <Box mt={1}>\r\n          <Typography variant={'caption'} color={'error'}>\r\n            Código incorrecto\r\n          </Typography>\r\n        </Box>\r\n      )}\r\n      <Box>\r\n        <Divider sx={{ my: 4 }}>\r\n          <Stack direction={'row'} spacing={1} justifyContent={'center'}>\r\n            {isSendingCode ? (\r\n              <CircularProgress wid sx={{ mx: 3 }} />\r\n            ) : (\r\n              <>\r\n                <Typography variant={'body2'}>¿No tengo un código?</Typography>\r\n                <Link underline={'hover'} sx={{ cursor: 'pointer' }} onClick={handleResendCode}>\r\n                  <Typography variant={'body2'} color={'primary'}>\r\n                    Reenviar código\r\n                  </Typography>\r\n                </Link>\r\n              </>\r\n            )}\r\n          </Stack>\r\n        </Divider>\r\n      </Box>\r\n      <Stack px={5}>\r\n        <Button\r\n          size=\"large\"\r\n          variant={'outlined'}\r\n          color={'inherit'}\r\n          onClick={() => {\r\n            setStep(CARD_ASSIGN_PROCESS_LIST.CARD_VALIDATION)\r\n          }}\r\n        >\r\n          Cancelar\r\n        </Button>\r\n      </Stack>\r\n    </Stack>\r\n  )\r\n}\r\n"],"names":["FormDemoUserValidation","setStep","useCardUserAssign","state","setStepAssignRegister","user","token","otp","setOtp","useState","mutate","sendValidationCode","isLoading","isSendingCode","useSendValidationCode","validateCode","isValidatingCode","isError","isErrorValidatingCode","reset","useValidateCode","handleChange","newValue","validateChar","value","index","matchIsNumeric","handleComplete","axios","defaults","headers","common","Authorization","verificationCode","onSuccess","CARD_ASSIGN_PROCESS_LIST","CARD_REGISTER","onError","handleResendCode","Stack","jsx","LogoSphere","Typography","jsxs","mb","email","MuiOtpInput","gap","xs","sm","md","placeholder","error","disabled","Boolean","Box","Divider","my","CircularProgress","mx","Fragment","Link","cursor","Button","CARD_VALIDATION"],"mappings":"gcAYA,SAAwBA,GAAyB,CAC/C,MAAMC,EAAUC,EAA2BC,GAAAA,EAAMC,qBAAqB,EAChEC,EAAOH,EAA2BC,GAAAA,EAAME,IAAI,EAC5CC,EAAQJ,EAA2BC,GAAAA,EAAMG,KAAK,EAC9C,CAACC,EAAKC,CAAM,EAAIC,WAAS,EAAE,EAC3B,CAAEC,OAAQC,EAAoBC,UAAWC,GAAkBC,EAAsB,EACjF,CAAEJ,OAAQK,EAAcH,UAAWI,EAAkBC,QAASC,EAAuBC,MAAAA,GAAUC,EAAgB,EAE/GC,EAA2BC,GAAA,CAC/Bd,EAAOc,CAAQ,EACTH,GAAA,EAGFI,EAAeA,CAACC,EAAOC,IAAUC,EAAeF,CAAK,EAErDG,EAA0BH,GAAA,CAC9BI,EAAMC,SAASC,QAAQC,OAAOC,cAAiB,UAAS1B,CAAM,GAE5DS,EAAA,CAAEkB,iBAAkBT,EAAOlB,MAAAA,CAAAA,EAC3B,CACE4B,UAAWA,IAAM,CACfjC,EAAQkC,EAAyBC,aAAa,CAChD,EACAC,QAASA,IAAM,CACb7B,EAAO,EAAE,CACX,CAAA,CAEJ,CAAA,EAGI8B,EAAmBA,IAAM,CAC7BV,EAAMC,SAASC,QAAQC,OAAOC,cAAiB,UAAS1B,CAAM,GAC3CK,GAAA,EAGrB,cACG4B,EACC,CAAA,SAAA,CAAAC,EAAA,IAACC,EAAa,EAAA,EAEdD,EAAAA,IAACE,GAAW,QAAQ,KAAK,MAAM,cAAc,MAAM,SAAS,SAE5D,2CAAA,CAAA,EAECC,EAAAA,KAAAD,EAAA,CACC,UAAS,GACT,GAAI,CAAEE,GAAI,CAAA,EACV,MAAM,SACN,QAAQ,QACR,MAAO,iBACP,WAAW,WACZ,SAAA,CAAA,iCAC+BvC,GAAAA,YAAAA,EAAMwC,QAAS,IAAI,uCAAA,EACnD,EACAL,EAAAA,IAACM,EACC,CAAA,OAAQ,EACR,MAAOvC,EACP,WAAYoB,EACZ,SAAUN,EACV,aAAAE,EACA,GAAI,CAAEwB,IAAK,CAAEC,GAAI,IAAKC,GAAI,EAAGC,GAAI,CAAE,GACnC,gBAAiB,CAAEC,YAAa,IAAKC,MAAOlC,EAAuBmC,SAAUrC,CAAAA,EAC7E,EACDsC,EAAQpC,GACPsB,EAAA,IAACe,GAAI,GAAI,EACP,SAACf,EAAAA,IAAAE,EAAA,CAAW,QAAS,UAAW,MAAO,QAAS,4BAEhD,CAAA,EACF,EAEDF,EAAA,IAAAe,EAAA,CACC,SAACf,EAAAA,IAAAgB,EAAA,CAAQ,GAAI,CAAEC,GAAI,CAAA,EACjB,SAAAjB,EAAAA,IAACD,EAAM,CAAA,UAAW,MAAO,QAAS,EAAG,eAAgB,SAClD1B,SACCA,EAAA2B,EAAA,IAACkB,EAAiB,CAAA,IAAG,GAAC,GAAI,CAAEC,GAAI,CAAE,CAAA,CAAK,EAGrChB,EAAAA,KAAAiB,EAAA,SAAA,CAAA,SAAA,CAACpB,EAAA,IAAAE,EAAA,CAAW,QAAS,QAAS,SAAoB,uBAAA,EACjDF,EAAAA,IAAAqB,EAAA,CAAK,UAAW,QAAS,GAAI,CAAEC,OAAQ,SAAU,EAAG,QAASxB,EAC5D,SAACE,EAAA,IAAAE,EAAA,CAAW,QAAS,QAAS,MAAO,UAAW,SAAA,iBAAA,CAEhD,CACF,CAAA,CAAA,EACF,CAAA,CAEJ,CACF,CAAA,EACF,EACCF,EAAA,IAAAD,EAAA,CAAM,GAAI,EACT,SAACC,EAAAA,IAAAuB,EAAA,CACC,KAAK,QACL,QAAS,WACT,MAAO,UACP,QAAS,IAAM,CACb9D,EAAQkC,EAAyB6B,eAAe,CAAA,EAEnD,mBAED,CAAA,EACF,CACF,CAAA,CAAA,CAEJ"}